#!/bin/bash

export __ip="127.0.0.1"
export __port=8400

export __user=test
export __pass=test

if (( "$#" >= "1" )); then
    export __ip=$1
fi

if (( "$#" >= "2" )); then
    export __port=$2
fi

if (( "$#" >= "3" )); then
    export __user=$3
fi

if (( "$#" >= "4" )); then
    export __pass=$4
fi

echo "${__ip} ${__port} ${__user} ${__pass}"

set -x

read

for __ip in `seq 1 3`; do
    for __port in `seq 1000 1010`; do
        curl -u ${__user}:${__pass} -X POST --data "" http://${__ip}:${__port}/nat/port/127.0.0.${__ip}/${__ip}${__port}/tcp
        echo ""
        curl -u ${__user}:${__pass} -X POST --data "" http://${__ip}:${__port}/nat/port/127.0.0.${__ip}/${__ip}${__port}/udp
        echo ""
    done
done

read

for __ip in `seq 1 3`; do
    for __port in `seq 1005 1015`; do
        curl -u ${__user}:${__pass} -X POST --data "" http://${__ip}:${__port}/nat/port/127.0.0.${__ip}/${__ip}${__port}
        echo ""
    done
done

read

for __ip in `seq 1 3`; do
    curl -u ${__user}:${__pass} -X POST --data "" http://${__ip}:${__port}/nat/ip/127.0.1.${__ip}
    echo ""
done

read

curl -u ${__user}:${__pass} http://${__ip}:${__port}/nat/port
echo ""

for __ip in `seq 1 3`; do
    curl -u ${__user}:${__pass} http://${__ip}:${__port}/nat/port/127.0.0.${__ip}
    echo ""
done

curl -u ${__user}:${__pass} http://${__ip}:${__port}/nat/ip
echo ""

read

for __ip in `seq 1 3`; do
    for __port in `seq 1000 1010`; do
        curl -u ${__user}:${__pass} -X DELETE --data "" http://${__ip}:${__port}/nat/port/127.0.0.${__ip}/${__ip}${__port}/tcp
        echo ""
        curl -u ${__user}:${__pass} -X DELETE --data "" http://${__ip}:${__port}/nat/port/127.0.0.${__ip}/${__ip}${__port}/udp
        echo ""
    done
done

read

for __ip in `seq 1 3`; do
    for __port in `seq 1005 1015`; do
        curl -u ${__user}:${__pass} -X DELETE --data "" http://${__ip}:${__port}/nat/port/127.0.0.${__ip}/${__ip}${__port}
        echo ""
    done
done

read

for __ip in `seq 1 3`; do
    curl -u ${__user}:${__pass} -X DELETE --data "" http://${__ip}:${__port}/nat/port/127.0.0.${__ip}
    echo ""
done

for __id in `seq 1 2`; do
    curl -u ${__user}:${__pass} -X DELETE --data "" http://${__ip}:${__port}/nat/ip/127.0.1.${__id}
    echo ""
done

read

curl -u ${__user}:${__pass} -X DELETE --data "" http://${__ip}:${__port}/nat/ip/127.0.1.3
echo ""

read

curl -u ${__user}:${__pass} http://${__ip}:${__port}/
echo ""

read

for __ip in `seq 1 3`; do
    for __port in `seq 1000 1010`; do
        curl -u ${__user}:${__pass} -X POST --data "[{\"port\": ${__ip}${__port}, \"proto\": \"tcp\"}]" http://${__ip}:${__port}/dnat/127.0.0.${__ip}
        echo ""
        curl -u ${__user}:${__pass} -X POST --data "[{\"port\": ${__ip}${__port}, \"proto\": \"udp\"}]" http://${__ip}:${__port}/dnat/127.0.0.${__ip}
        echo ""
    done
done

read

for __ip in `seq 1 3`; do
    for __port in `seq 1005 1015`; do
        curl -u ${__user}:${__pass} -X POST --data "[{\"port\": ${__ip}${__port}, \"proto\": \"tcp\"}, {\"port\": ${__ip}${__port}, \"proto\": \"udp\"}]" http://${__ip}:${__port}/dnat/127.0.0.${__ip}
        echo ""
    done
done

read

curl -u ${__user}:${__pass} http://${__ip}:${__port}/dnat
echo ""

for __ip in `seq 1 3`; do
    curl -u ${__user}:${__pass} http://${__ip}:${__port}/dnat/127.0.0.${__ip}
    echo ""
done

read

for __ip in `seq 1 3`; do
    for __port in `seq 1000 1010`; do
        curl -u ${__user}:${__pass} -X DELETE --data "" http://${__ip}:${__port}/dnat/127.0.0.${__ip}/${__ip}${__port}/tcp
        echo ""
        curl -u ${__user}:${__pass} -X DELETE --data "" http://${__ip}:${__port}/dnat/127.0.0.${__ip}/${__ip}${__port}/udp
        echo ""
    done
done

read

for __ip in `seq 1 3`; do
    for __port in `seq 1005 1015`; do
        curl -u ${__user}:${__pass} -X DELETE --data "" http://${__ip}:${__port}/dnat/127.0.0.${__ip}/${__ip}${__port}
        echo ""
    done
done

read

for __ip in `seq 1 3`; do
    curl -u ${__user}:${__pass} -X DELETE --data "" http://${__ip}:${__port}/nat/port/127.0.0.${__ip}
    echo ""
done
